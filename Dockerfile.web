# … előző lépések változatlanok …

# Copy csproj-ok
COPY Terjeki.Scheduler.sln ./
COPY Terjeki.Scheduler.Core/*.csproj   Terjeki.Scheduler.Core/
COPY Terjeki.Scheduler.Infrastructure/*.csproj Terjeki.Scheduler.Infrastructure/
COPY Terjeki.Scheduler.Application/*.csproj    Terjeki.Scheduler.Application/
COPY Terjeki.Scheduler.Api/*.csproj            Terjeki.Scheduler.Api/
COPY Terjeki.Scheduler.Web/*.csproj            Terjeki.Scheduler.Web/

# Restore a teljes solution-re
RUN dotnet restore Terjeki.Scheduler.sln

# Másoljuk át a maradék forrást
COPY . .

# Publish csak a Blazor WebAssembly projektet
WORKDIR /src/Terjeki.Scheduler.Web
RUN dotnet publish -c Release -o /app/publish /p:UseAppHost=false

# Runtime
FROM nginx:alpine AS runtime
WORKDIR /usr/share/nginx/html
COPY --from=build /app/publish/wwwroot ./
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
